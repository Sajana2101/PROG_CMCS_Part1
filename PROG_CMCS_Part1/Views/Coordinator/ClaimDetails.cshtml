@model PROG_CMCS_Part1.Models.Claim
@using System.IO

@{
    ViewData["Title"] = "Claim Details";
}
<!-- Display claim information in a table -->
<h2>Claim Details</h2>

<table class="table table-bordered">
    <tr>
        <th>Lecturer</th>
        <td>@Model.LecturerName</td>
    </tr>
    <tr>
        <th>Module Code</th>
        <td>@Model.ModuleCode</td>
    </tr>
    <tr>
        <th>Month</th>
        <td>@Model.Month</td>
    </tr>
    <tr>
        <th>Hours Worked</th>
        <td>@Model.HoursWorked</td>
    </tr>
    <tr>
        <th>Hourly Rate</th>
        <td>R @Model.HourlyRate</td>
    </tr>
    <tr>
        <th>Total Amount</th>
        <td>R @Model.TotalAmount</td>
    </tr>
    <tr>
        <th>Status</th>
        <td>@Model.Status</td>
    </tr>
    <tr>
        <th>Coordinator</th>
        <td>@(!string.IsNullOrEmpty(Model.CoordinatorName) ? Model.CoordinatorName : "-")</td>
    </tr>
   
    <tr>
        <th>Manager</th>
        <td>@(!string.IsNullOrEmpty(Model.ManagerName) ? Model.ManagerName : "-")</td>
    </tr>
    
    <tr>
        <th>Comments</th>
        <td>@(!string.IsNullOrEmpty(Model.Comments) ? Model.Comments : "-")</td>
    </tr>
    <tr>
        <th>Date Submitted</th>
        <td>@Model.DateSubmitted.ToString("dd MMM yyyy")</td>
    </tr>
    <tr>
        <th>Uploaded Documents</th>
        <td>
            <!-- List uploaded files with download links -->
            @if (Model.EncryptedDocuments != null && Model.EncryptedDocuments.Any())
            {
                <ul>
                    @for (int i = 0; i < Model.EncryptedDocuments.Count; i++)
                    {
                        var encryptedFile = Model.EncryptedDocuments[i];
                        var originalName = Model.OriginalDocuments.Count > i
                        ? Model.OriginalDocuments[i]
                        : encryptedFile; 

                        <li>
                            <a asp-action="DownloadFile"
                               asp-controller="Lecturer"
                               asp-route-claimId="@Model.Id"
                               asp-route-file="@encryptedFile">
                                @originalName
                            </a>
                        </li>
                    }
                </ul>
            }
            else
            {
                <span>No documents uploaded</span>
            }
        </td>
    </tr>
